# Generative-Adversarial-Spatial-Transformer-Network (GASTN)

[Spatial Transformer Network](https://arxiv.org/pdf/1506.02025.pdf), proposed by Max Jaderberg, Karen Simonyan, Andrew Zisserman and Koray Kavukcuoglu, is used to solve the spatial invariant problem of CNN model. In the origin paper, STN is a module which can be inserted anywhere in the network. Therefore, this repository consturcts a Generative Adversarial Network using Spatial Transformer Network to detect and orthorify the object from an image. In this repo, we use this GASTN to detect and orthorify the license plate of Taiwan from an image. However, due to lack of car plate images, this repo only adopts approximately 100 of training data and several testing data.

## Spatial Transformer Network

Spatial transformer network is composed of 3 elements:
* **Localization network (LN)**:
Localization network takes the image or feature map as input and output 6 parameters. These 6 parameters will be used as affine transformation of the input image (or feature map).

* **Grid generator**:
Grid generator generate a new grid of x,y coordinate from input image (or feature map) via affine transformation where the parameters are provided by localization network.

* **Sampler**:
Since the output parameters of localization network is not usually integers, sampler is used to interpolate pixel value from input image (or feature map) and produce new value for new grid generated by grid generator.

## Requisite

* python 3.8
* tensorflow 2.5.0
* Cuda 11.1
* CuDNN 8.1.1

## Network Structure
The network is composed of a STN generator and a discriminator. The STN generator is used for spatial transformation of the input image. The discriminator distinguish the orthorified image and non-orthorified image.

### STN Generator
Generator is a single STN. This repo only modify the localization net of STN, which is shown in below.

### Discriminator
Discriminator follows the structure of [PatchGAN](https://arxiv.org/pdf/1611.07004v3.pdf)

### Loss
**Vanilla GAN loss:**  

**L2 loss:**  

## Getting Started
* Clone this repository

      git clone https://github.com/Rayhchs/Generative-Adversarial-Spatial-Transformer-Network.git
      cd Generative-Adversarial-Spatial-Transformer-Network
      
* Clone STN module from [spatial-transformer-network](https://github.com/kevinzakka/spatial-transformer-network)

      git clone https://github.com/kevinzakka/spatial-transformer-network.git
    
* Train

      python -m main train
    
**Afterward, input the direction of input **

* For training detail:

      tensorboard --logdir=./log

* Test
      python -m main test
      
**Then, input the direction of testing data**

## Results

## Acknowledge
STN code is borrowed from [spatial-transformer-network](https://github.com/kevinzakka/spatial-transformer-network). Thanks for the excellent work!
